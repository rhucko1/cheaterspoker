<!doctype html>
<html>
	<head>
		<title>Cheater's Poker... Erdnase Edition</title>
			<script src="./characters.js"></script>
			<script>
	/***************************************************************************
	Copyright 2022 The Disclaimer Magazine 
	Website: https://ko-fi.com/thedisclaimer

	Based on Al Stangerâ€™s Miracle Poker Machine by Al Stanger, John Mendoza, Gaetan Bloom

	4 Card Coding method used here is Derrick Chung's brilliant idea. In his method it allows any 4 cards to key a 5th card using a Low/Med/High sequence and setting
	the position of the highest card in the set to represent the suit; however, if the 5th card was 7 or above, at least one card would be reversed to indicate that 
	and represent a 0 (the other face up cards used as 1 values) then used binary (Octal) to determine value.
	Keeping the same concept for A-6, but setting a high mode to differentitate and using same LMH method for high cards works, but leaves out 1 value (King) which will
	be represented with a different king mode (assuming value is a king). 
				 
	High mode may also be obtained by representing the high card as a capital 'X' when providing input as a positional placeholder.
	
	(note: does not conform to the original Fitch Cheney problem, but works nicely in practice).

	Optional 5 Card Coding method is Alex Elmsley's from The Looking Glass Winter 1998 (Coding By Permutation) p. 161
	This allows one method for representing a 6th card of any value/suit. Very nice but doesn't conform to a 5 card stud theme, if that is important to you. 
	If a fictional game of Texas Holdem with one hole card or 6 card stud is presented, this way works nicely. 

	Ideas by Derrick Chung, Curtis Kam, Richard Hucko, Al Stanger, John Mendoza, Gaetan Bloom, Alex Elmsley
	Author: Richard Hucko
	***************************************************************************/
	const LMH={
					"LMH":"A",
					"LHM":"2",
					"MLH":"3",
					"MHL":"4",
					"HLM":"5",
					"HML":"6",
				}, //LMH used for A-6 in 4 card encoding
			values=[
					["A","2","3","4","5"],
					["6","7","8","9","10"],
					["J","Q","K"],
				], //values arranged positionally for 5 card encoding
				suits=[
						{letter:"S", icon:"&spades;", value:'0'},
						{letter:"H", icon:"&hearts;", value:'13'},
						{letter:"C", icon:"&clubs;", value:'26'},
						{letter:"D", icon:"&diams;", value:'39'},
				];	
	let hand=[
						{letter:"AS", icon:"A&spades;", value:'1'},
						{letter:"AH", icon:"A&hearts;", value:'14'},
						{letter:"AC", icon:"A&clubs;", value:'27'},
						{letter:"AD", icon:"A&diams;", value:'40'},
						{letter:"JS", icon:"J&spades;", value:'11'},
				],
				temphand=[], //used to initially set hand (and for simple checks later)
				forcehands=[[],[]], //0 = first hand in round with 4 cards, 1 = first hand in round with 5 cards
				holecard="", //player's hole card (decoding result or overriden result)
				highest, //highest card (used in 4 card coding where index denotes suit)
				mode="low", //toggle mode in 4 card coding low/high/king to cover Low: (A-6), High: (7-Q), King: K
				code=""; /* 
				 4 Card Encoding Format
				 ------------------------
					(A-6)	mode: low, format: LMH
					(7-Q) mode: high, format: LMH (add 6 when decoding)
					K mode: king, format: N/A

				 5 Card Encoding Format
				 ------------------------
				 format: p/s/g	(p=position (for value in column), s=suit (position), g=group (row)

				 since arrays are 0-index based, may need to subtract 1 to each before referencing

				 range for p is 1-5 (or 0-4 in array)
				 range for s is 1-4 (or 0-3 in array)
				 range for g is 1-3 (or 0-2 in array)

				 2/3/2 (-1 for all) = 1/2/1 = 7C

				 In array, p and g are referenced together to get value
				 ex. for 7, values[1][1]=7

				 For suit (s), reference index then either .icon or .letter
				 ex. for Clubs, suits[2].letter=C		- OR -	 suits[2].icon=&clubs;

				 suits[i].value is used for sorting (value is added to card value to determine if higher or lower). This is used to sort with suits and allows uniquely identifying each card.
				 */
		const elem2index=(elem)=>parseInt(elem)-1;
		const getSuit=(card)=>card.slice(-1).toUpperCase();
		const getValue=(card)=>{
			let v=parseInt(card)?parseInt(card):card.substring(0,1).toUpperCase(); //value initial (if parseInt fails it means it's not a number value but has a single letter value (ex. J, Q, K, A))
			return v;	
		}
		const compare=(a,b)=>{
			a=parseInt(a);
			b=parseInt(b);
			if(a===b)
				return "eq";
			else if(a<b)
				return "lt";
			else if(a>b)
				return "gt";
			else
				return -1;
		}
		const cardCompare=(card1,card2)=>{
			//requires hand[i].value to be set (ex. run setHand())
			//2 args to compare ex. hand[0], hand[1]
			//assumes hand[i].value is unique value ID so no dups (ID based on card val + suit val)
			card1=parseInt(card1.value);
			card2=parseInt(card2.value);
			if(card1<card2)
				return "lt";
			else if(card1>card2)
				return "gt";
			else
				return -1;			
		}
		const isLMH=(str)=>{
			//assumes compare() or cardCompare() have been called successfully twice previously with results appended ("eq" values converted to "lt" or "gt")
			str=String(str);
			if(str.match(/(?:lt){2}/))
				return "L";
			else if(str.match(/(?:gt){2}/))
				return "H";
			else if(str.match(/(?:ltgt|gtlt)/))
				return "M";
			else
				return -1;
		}
		const getSuitID=(index)=>suits[index].value;
		const getCardID=(value,suit)=>{
			//value obtained by either: values[i][i] or from getValue(card)
			//suit is index of suit 0-3
			//returns card ID number to uniquely represent card in deck (ordering lowest to highest based on suit and value)
			const v=getValueID(value),
					s=getSuitID(suit);
			return parseInt(v)+parseInt(s);
		}
		const getValueID=(value)=>{
			//value ID is the numeric representation of card's value (ex. A=1, 2...10, J=11, Q=12, K=13)
			let v=parseInt(value)?parseInt(value):value.substring(0,1).toUpperCase(); //value initial (if parseInt fails it means it's not a number value but has a single letter value (ex. J, Q, K, A))
				switch(v){
					case 'A':
							v='1';
							break;
					case 'J':
							v='11';
							break;
					case 'Q':
							v='12';
							break;
					case 'K':
							v='13';
							break;
					default:
							v=v;
				}
				return v;
		}
		const getCardVal=(v)=>{
			//takes numeric card value and converts back to card value
			switch(v){
					case '1':
							v='A';
							break;
					case '11':
							v='J';
							break;
					case '12':
							v='Q';
							break;
					case '13':
							v='K';
							break;
					default:
							v=v;
				}
				return v;
		}
		const getHighCardPos=()=>{
			//assumes both temphand is set (use setTempHand(...)) and hand is set (use setHand())
			let tempvals=[],
					highcard,
					dupvals=[]; //array of dup ID vals

			//check for placeholder x
			if(temphand.indexOf("X")!=-1){
				mode="high";
				return temphand.indexOf("X");
			}

			// get values from temphand
			for(let v of temphand)
				tempvals.push(getValueID(v));

			tempvals.sort(function(a, b){return b-a}); //sort tempvals highest to lowest (tempvals[0] is the highest value)
			highcard=tempvals[0];
	
			if(tempvals[0]>tempvals[1]){	//no high card dups
				for(let i in temphand)
					if(getValueID(temphand[i])==highcard)
						return i;	
			}else{ //high card dups
				for(let i in temphand)
					if(getValueID(temphand[i])==highcard)
						dupvals.push(hand[i].value);
				dupvals.sort(function(a, b){return b-a}); //sort dupvals highest to lowest (dupvals[0] is the highest value)
				for(let i in temphand)
					for(let s in suits)
						if(suits[s].letter===getSuit(temphand[i]))
							if(compare(getCardID(getValue(temphand[i]),s),dupvals[0])=="eq")
								return i;
			}
		}	
		function setTempHand(){
			//vairable # arguments accepted
			//if one arg supplied, create array splitting on space/comma combinations
			temphand=[]; //reset temphand
			if(arguments.length==1)
				arguments=arguments[0].split(/[ ,]+/);
			for(let arg of arguments)
				temphand.push(arg);	
		}
		const setHand=()=>{
			//temphand must be set from setTempHand("...") prior to this function call
			//if(temphand.length!=5)
			//	return -1;
			if(temphand.length==4 && hand.length==5)
				hand.pop();
			if(temphand.length==5 && hand.length==4)
				hand.push({letter:"JS", icon:"J&spades;", value:'11'}); //add a placeholder

			hand.forEach(function(v,k){
				//set letter, icon, and value for each card
				let value=getValue(temphand[k]),
						suit=getSuit(temphand[k]);
				hand[k].letter=temphand[k]; //letter
				for(let i in suits){
					if(getSuit(suits[i].letter)===suit){
						hand[k].icon=value+suits[i].icon; //icon
						hand[k].value=getCardID(value,i); //value
					}
				}
			});
		}
		const encode=()=>{
			//set code (format: p/s/g)
			//assumes hand is set via setHand()
			code=""; //reset code

			if(temphand.length==5){
				//Alex Elmsley method 5 card encoding
					let cnt=0;
					for(let i=0;i<3;i++){
						for(let j=i;j<hand.length;j++)
							if(hand[j].value<hand[i].value)
								cnt++;
							code+=cnt+"/";
							cnt=0;
					}
					code=code.slice(0,-1); //strip trailing /
			}else if(temphand.length==4){
				//Derrick Chung method 4 card encoding
				let cursor=[], //lt/gt values array
						temparray=[], //used for determining card value (won't include highcard from temparray)
						handclone=hand.map(a => {return {...a}}); //clone hand
				if(hand.length==5)
					hand.pop(); //remove placeholder card

				//get High Card position and remove from handclone (also don't include in temparray)
				highest=getHighCardPos();	
				for(let i in temphand){
					if(i!=highest)
						temparray.push(temphand[i]);
					else
						handclone.splice(i,1);
				}

				//determine lt/gt values and add to cursor array
				for(let i in temparray){
					let result;
					cursor.push("");
					for(let j in temparray){
					 if(i!=j){
							result=compare(getValueID(temparray[i]),getValueID(temparray[j]));
							if(result!="eq")
								cursor[i]+=result; //console.log(`${i} = ${arr[i]}; ${j} = ${arr[j]}`);		
							else
								cursor[i]+=cardCompare(handclone[i],handclone[j]);
						}
					}
				}
				//assign LMH values to code
				for(let v of cursor)
					code+=isLMH(v);
			}
		}
		const decode=()=>{
			//requires code to be set (call encode() first)
			let codetemp;
			if(code==="")
				return -1;
			if(hand.length==5){
				let codetemp=code.split("/");
				if(codetemp.length!=3)
					return -2;
				return values[codetemp[2]][codetemp[0]]+suits[codetemp[1]].letter;
			}else if(hand.length==4){
				if(code.length!=3)
					return -2;
				switch(mode){
					case 'low':
								return LMH[code]+suits[highest].letter;	
								break;
					case 'high':
								const offset=6;
								return getCardVal(String(parseInt(getValueID(LMH[code]))+parseInt(offset)))+suits[highest].letter;
								break;
					case 'king':
								return "K"+suits[highest].letter;
								break;
					default:
								return -3;
				}
			}
		}
			///////////////////// Additional Functions /////////////////////

		const isRed=(card)=>{
			if((getSuit(card)=="C") || (getSuit(card)=="S"))
				return false;
			else
				return true;
		}

		const getSuitSymbol=(suit)=>{
			//pass suit letter (after calling getSuit(card) prior)
			for(let i in suits)
				if(suits[i].letter==suit)
					return suits[i].icon;
		}

				//////////////////// Game Section /////////////////////
				/* Classes defined in characters.js */
				let Timer,
						refresh=100,
						counter=0, //controls cursor/display
						storyo,
						storyi,
						scene=1; //scene increments per round (starts from 1 and increments, 0 reserved for last scene)
				const showHideKeys=()=>{
								if(keyboard.style.display=="block"){
									keyboard.style.display="none";
									window.scrollTo(0,0);
								}else{
									keyboard.style.display="block";
									window.scrollTo(800,800);
								}
				}

				const init=()=>{
							storyo=document.getElementById("storyboard-outer"),
							storyi=document.getElementById("storyboard-inner"),
							statusboard=document.getElementById("status-board"),
							generalmessage=document.getElementById("general-message"),
							keyboard=document.getElementById("keyboard"),
							cards=document.getElementById("cards"),
							chat=document.getElementById("chat"),
							fgimg=document.getElementById("fgimg"),
							fgdiv=document.getElementById("fgdiv"),
							fgtalk=document.getElementById("fgtalk"),
							bgimg=document.getElementById("bgimg"),
							bgdiv=document.getElementById("bgdiv"),
							container=document.getElementById("story-container"),
							cardOnSign=document.getElementById("itwaswritten"),
							messages=["Welcome, to a land of poker, cheating, and much more. . .","Prepare yourself for Cheater's Poker - Erdnase Edition."],
							messageCounters=[0,0],
							story=true, //toggle story on/off
							pause=0, //pregame counter
							pauses=[0,0], //counters for scenes [0] is reserved for final scene, will push(0) at the end of each scene
							firstRun=true,
							Evans=new Character("Evans",3),
							Amos=new Character("Amos",2.5),
							Isabel=new Character("Isabel",4),
							Ned=new Character("Ned",3),
							Barkeep=new Character("Barkeep",3),
							Dealer=new Character("Dealer",4),
							Dog=new Character("Dog",4),
							Andrews=new Character("Andrews",3),
							Saloon=new StageItem("Saloon",4),
							Doors=new StageItem("Doors",5),
							Sign=new StageItem("LuckyCardSign",3),
							Chips=new StageItem("Chips",3),
							Shuffle=new StageItem("Overhand",3),
							Table=new StageItem("Table",3),
							introOutro=new Audio("./sounds/intro-outro.mp3"),
							heartbeat=new Audio("./sounds/heartbeat.wav"),
							suspense=new Audio("./sounds/suspense.mp3"),
							drinkPour=new Audio("./sounds/drink.mp3"),
							pub=new Audio("./sounds/pub.mp3"),
							overhand=new Audio("./sounds/overhand.mp3"),
							riff=new Audio("./sounds/riffle.mp3"),
							deal=new Audio("./sounds/deal.mp3"),
							drumSound=new Audio("./sounds/drums.wav");

							drumSound.playbackRate=1;

							//Additional image preloads for non-defaults
							emptyTable=new Image();
								emptyTable.src="images/Table-empty.png";
							drink=new Image();
								drink.src="images/Drink.png";
							wanted=new Image();
								wanted.src="images/Wanted.png";
							riffle=new Image();
								riffle.src="images/Riffle.png";
							spring=new Image();
								spring.src="images/Spring.png";
							pokerStandOff=new Image();
								pokerStandOff.src="images/PokerStandOff.png";
							gunOut=new Image();
								gunOut.src="images/GunPointed.png";
							table4=new Image();
								table4.src="images/Table-4.png";
							table5=new Image();
								table5.src="images/Table-5.png";
							cheat=new Image();
								cheat.src="images/Cheat.png";
							//End additional image preloads

							preGame();

							document.getElementById("story").addEventListener("click",toggleStory);
							document.getElementById("showhidekeys").addEventListener("click",showHideKeys);
							document.getElementById("play").addEventListener("click",game);
				}

				const preGame=()=>{
					const play=document.getElementById("play");
					if(messageCounters[0]<=messages[0].length){
						chat.innerHTML=messages[0].slice(0,messageCounters[0]);
						messageCounters[0]++;
					}else if(pause<5){	
						pause++;
					}else if(messageCounters[1]<=messages[1].length){
						chat.innerHTML=messages[1].slice(0,messageCounters[1]);
						messageCounters[1]++;
					}else if(pause<10){	
						pause++;
					}else if(pause<12){
						play.style.backgroundColor="black";
						play.style.color="green";
						pause++;
					}else{
						play.style.backgroundColor="green";
						play.style.color="black";
					}
					Timer=setTimeout(preGame, refresh);
				}

				const game=()=>{
					if(firstRun){
						clearTimeout(Timer);
						cards.innerHTML=chat.innerHTML="";
						cards.style.position="absolute";
						cards.style.textAlign="left";
						firstRun=false;
					}

					if(counter<5){
						//statusboard.innerHTML=`${counter}`;
						counter++;
					}else{
						//handle display cursor
						if(cards.innerHTML.slice(-1)=="_")
							cards.innerHTML=cards.innerHTML.slice(0,-1);
						else
							cards.innerHTML+='_';
						counter=0;
					}	

					//Scenes	
					if(story){
						switch(scene){
							case 1:
								if(pauses[1]<5){
										introOutro.volume=1;
										introOutro.play();
										keyboard.style.display="none";
										pauses[1]++;
									}else if(pauses[1]<25){
										fgimg.style.visibility="hidden";
										fgtalk.style.visibility="hidden";	
										bgimg.src=Saloon.img.src;
										Saloon.setScale();
										Saloon.setDimensions("200px","85px");
										Saloon.setPos("200px","135px");
										bgimg.style.visibility="visible";
										chat.style.textAlign="center";
										chat.innerHTML="[Saloon]";
										pauses[1]++;
									}else if(pauses[1]<35){
										bgimg.src=Doors.img.src;
										Amos.setScale();
										fgimg.src=Amos.avatar;
										Amos.setPos("15px","-50px");
										pauses[1]++;
									}else if(pauses[1]<55){
										Sign.setScale();
										Sign.setDimensions("100px","110px");
										Sign.setPos("40px","115px");
										fgimg.style.visibility="visible";
										fgtalk.style.visibility="visible";
										Amos.speak("bubble-left","Howdy, partner!");
										bgimg.src=Sign.img.src;
										pauses[1]++;
									}else if(pauses[1]<85){
										fgimg.style.visibility="hidden";
										fgtalk.style.visibility="hidden";
										pub.volume=0.25;
										pub.play();
										pauses[1]++;	
									}else if(pauses[1]<110){
										bgimg.src=Table.img.src;
										Table.setDimensions("260px","110px");
										Table.setPos("170px","130px");
										bgimg.style.visibility="visible";
										Table.setScale();
										chat.innerHTML="[Dealer] Welcome to town, partner. Have a Seat.";
										pauses[1]++;
									}else if(pauses[1]<115){
										chat.innerHTML="";
										pauses[1]++;
									}else if(pauses[1]<140){
										chat.innerHTML=`[Dealer] The game's Liar's Poker.`;
										pauses[1]++;
									}else if(pauses[1]<145){
										chat.innerHTML="";
										pauses[1]++;
									}else if(pauses[1]<200){
										chat.innerHTML=`[Dealer] You tell me your "up" cards and I bet I can tell you your hole card.`;
										pauses[1]++;
									}else if(pauses[1]<205){
										chat.innerHTML="";
										pauses[1]++;
									}else if(pauses[1]<255){
										bgimg.src=emptyTable.src;
										chat.innerHTML=`[Dealer] If I'm wrong, you win. If I'm close, it's a draw.`;
										pauses[1]++;
									}else if(pauses[1]<260){
										bgimg.src=emptyTable.src;
										chat.innerHTML="";
										pauses[1]++;
									}else if(pauses[1]<310){
										chat.innerHTML=`[Dealer]  But if I nail it, that's a 50 to 1 bet, you only pay 10 to 1.`;
										pauses[1]++;
									}else if(pauses[1]<315){
										overhand.play();
										chat.innerHTML="";
										pauses[1]++;
									}else if(pauses[1]<355){
										chat.innerHTML=`[Dealer]  Gentlemen, let's play some cards!`;
										pauses[1]++;
									}else if(pauses[1]<360){
										chat.innerHTML="";
										pauses[1]++;
									}else if(pauses[1]<410){
										Shuffle.setScale();
										overhand.play();
										bgimg.src=Shuffle.img.src;
										Ned.speak("console","Shuffle 'em up real good now, ya hear.");	
										pauses[1]++;
									}else if(pauses[1]<415){
										chat.innerHTML="";
										pauses[1]++;
									}else if(pauses[1]<465){
										Ned.speak("console","Kid, put your faith in providence, but always cut the cards.");	
										pauses[1]++;
									}else if(pauses[1]<470){
										chat.innerHTML="";
										pauses[1]++;
									}else if(pauses[1]<475){
										bgimg.src=emptyTable.src;
										overhand.pause();
										deal.play();		
										pauses[1]++;
									}else if(pauses[1]<515){
										chat.innerHTML="[Dealer] Alright, fellas. Ante up.";
										fgimg.src=Chips.img.src;
										fgimg.style.visibility="visible";
										cards.innerHTML="";
										pauses[1]++;
									}else{
										pub.pause();
										pauses.push(0);
										promptUser();	
									}
									break;

							case 2:
									if(pauses[2]<25){
										keyboard.style.display="none";
										fgimg.src=Dealer.avatar;
										Dealer.setScale();
										Dealer.setPos("0px","-70px");
										pauses[2]++;
									}else if(pauses[2]<85){
										let color=isRed(holecard)?"red":"black",
												suit=getSuitSymbol(getSuit(holecard)),
												val=holecard.slice(0,-1);
										hideMessage();
										pub.volume=0.25;
										pub.loop=true;
										pub.play();
										bgimg.style.visibility="hidden";
										fgimg.style.visibility="visible";
										fgtalk.style.visibility="visible";
										Dealer.speak("bubble-left",`I'm calling your bluff kid. You're holding the <span style="color:${color};">${val}${suit}</span>`);
										chat.innerHTML="[Dealer]";
										pauses[2]++;
									}else if(pauses[2]<90){
										chat.innerHTML="";
										Table.img.src=(temphand.length==4)?table4.src:table5.src;
										bgimg.src=Table.img.src;
										fgimg.style.visibility="hidden";
										fgtalk.style.visibility="hidden";
										pauses[2]++;
									}else if(pauses[2]<120){
										Amos.speak("console","Looks like you need a drink.");
										bgimg.style.visibility="visible";
										Amos.setPos("0px","-75px");
										fgimg.src=Amos.avatar;
										pauses[2]++;
									}else if(pauses[2]<125){
										chat.innerHTML="";
										pauses[2]++;
									}else if(pauses[2]<150){
										bgimg.style.visibility="hidden";
										fgimg.style.visibility="visible";
										fgtalk.style.visibility="visible";
										fgtalk.style.zIndex="3";
										Amos.setScale();
										Amos.speak("bubble-left","Barkeep, get this man a drink!");
										chat.innerHTML="[Amos]";
										pauses[2]++;
									}else if(pauses[2]<190){
										Amos.speak("bubble-left","Don't worry, kid. This one's on me.");
										pauses[2]++;
									}else if(pauses[2]<220){
										Barkeep.setScale();
										Barkeep.setPos("-570px","-100px");
										fgimg.src=Barkeep.avatar;
										Barkeep.speak("bubble-right","One drink coming right up!");
										chat.innerHTML="[Drink Request]";
										pauses[2]++;
									}else if(pauses[2]<260){
										drinkPour.play();
										fgimg.src=drink.src;
										fgtalk.style.zIndex="3";
										Barkeep.speak("bubble-right","This will cure what ails yah.");
										chat.innerHTML="[Drink Up]";
										pauses[2]++;
									}else if(pauses[2]<290){
										chat.innerHTML="";
										pauses[2]++;
									}else if(pauses[2]<320){
										drinkPour.pause();
										chat.innerHTML="[Isabel]";
										document.getElementById("fgimg").src=Isabel.avatar;
										Isabel.flip(); //for bubble-right
										Isabel.setPos("-490px","-70px");
										Isabel.speak("bubble-right","<br>Hey there stranger!<br><br>");
										pauses[2]++;	
									}else if(pauses[2]<360){
										Isabel.setPos("-490px","-105px");
										Isabel.speak("bubble-right","Don't wear yourself out playing cards... Save some energy for me!");
										bgimg.src=Table.img.src;
										pauses[2]++;	
									}else if(pauses[2]<365){
										chat.innerHTML="";
										pauses[2]++;	
									}else if(pauses[2]<395){
										Dealer.speak("console","Fellas, I gotta go take care of something.");
										Dealer.speak("bubble-left","Don't worry. Your new dealer, Andrews, will take good care of you.");
										Dealer.setPos("0px","-70px");
										fgimg.src=Dealer.avatar;
										fgimg.style.visibility="hidden";
										fgtalk.style.visibility="hidden";
										bgimg.style.visibility="visible";
										pauses[2]++;	
									}else if(pauses[2]<400){
										chat.innerHTML="";
										pauses[2]++;	
									}else if(pauses[2]<445){
										chat.innerHTML="[Switching Dealers]";
										fgimg.style.visibility="visible";
										fgtalk.style.visibility="visible";
										bgimg.style.visibility="hidden";	
										pauses[2]++;	
									}else if(pauses[2]<450){
										chat.innerHTML="";
										pauses[2]++;	
									}else if(pauses[2]<485){
										fgimg.src=Amos.avatar;
										Amos.setPos("0px","-75px");
										Amos.setScale();
										Amos.speak("bubble-left","Careful kid. I heard he cheats.");
										pauses[2]++;	
									}else if(pauses[2]<515){
										Andrews.setScale();
										chat.innerHTML="[Andrews]";
										fgimg.src=cheat.src;
										Amos.speak("bubble-left","Howdy, I'll be taking over for now.");
										Andrews.setScale();
										Andrews.setPos("15px","-50px;");
										pauses[2]++;	
									}else if(pauses[2]<520){
										fgimg.src=Andrews.avatar;
										Andrews.speak("bubble-left","Alright, boys. Money on the table, no go to the pockets.");
										pauses[2]++;	
									}else if(pauses[2]<545){
										chat.innerHTML="[Shuffling]";
										riff.play();
										pauses[2]++;	
									}else if(pauses[2]<595){
										bgimg.style.visibility="visible";
										fgimg.style.visibility="hidden";
										fgtalk.style.visibility="hidden";
										riff.loop=true;
										Shuffle.img.src=riffle.src;
										Shuffle.setScale();
										Shuffle.setDimensions("80px","100px");
										Shuffle.setPos("280px","135px");
										bgimg.src=Shuffle.img.src;	
										pauses[2]++;
									}else if(pauses[2]<600){
										bgimg.style.visibility="hidden";
										pauses[2]++;
									}else if(pauses[2]<630){
										bgimg.style.visibility="visible";
										Shuffle.setDimensions("80px","100px");
										Shuffle.img.src=spring.src;
										bgimg.src=Shuffle.img.src;
										pauses[2]++;
									}else if(pauses[2]<635){
										chat.innerHTML="";
										pauses[2]++;
									}else if(pauses[2]<640){
										Table.setDimensions("260px","110px");
										Table.setPos("170px","130px");
										Table.setScale();
										bgimg.src=emptyTable.src;
										deal.play();		
										pauses[2]++;
									}else if(pauses[2]<670){
										Andrews.speak("console","Ok, Gents. Ante Up.");
										fgimg.src=Chips.img.src;
										fgimg.style.visibility="visible";
										cards.innerHTML="";
										pauses[2]++;
									}else{
										riff.pause();
										pub.pause();
										pauses.push(0);
										promptUser();
									}
									break;
							case 3:
									if(pauses[3]<25){
										keyboard.style.display="none";
										fgimg.src=Andrews.avatar;
										Andrews.setScale();
										Andrews.setPos("15px","-50px;");
										pauses[3]++;
									}else if(pauses[3]<85){
										let color=isRed(holecard)?"red":"black",
												suit=getSuitSymbol(getSuit(holecard)),
												val=holecard.slice(0,-1);
										hideMessage();
										pub.volume=0.25;
										pub.loop=true;
										pub.play();
										bgimg.style.visibility="hidden";
										fgimg.style.visibility="visible";
										fgtalk.style.visibility="visible";
										Andrews.speak("bubble-left",`You can put down the <span style="color:${color};">${val}${suit}</span>! This game's all mine.`);
										chat.innerHTML="[Andrews]";
										pauses[3]++;
									}else if(pauses[3]<120){
										Dog.setScale();
										Dog.setPos("15px","-70px");
										fgimg.src=Dog.avatar;
										Dog.speak("bubble-left","Don't worry kid, you'll get 'em next time.");
										chat.innerHTML="";
										pauses[3]++;
									}else if(pauses[3]<125){
										Table.img.src=(temphand.length==4)?table4.src:table5.src;
										bgimg.src=Table.img.src;
										pauses[3]++;
									}else if(pauses[3]<150){
										fgtalk.style.visibility="hidden";
										fgimg.style.visibility="hidden";
										bgimg.style.visibility="visible";
										chat.innerHTML="[Isaac] Boss... boss..";
										pauses[3]++;
									}else if(pauses[3]<190){
										chat.style.textAlign="left";
										Ned.speak("console","Andrews, man. I thought I had you on this one.");
										pauses[3]++;
									}else if(pauses[3]<195){
										chat.innerHTML="";
										pauses[3]++;
									}else if(pauses[3]<235){
										Andrews.speak("console","One second folks. Isaac, what're you saying?");
										pauses[3]++;
									}else if(pauses[3]<240){
										chat.innerHTML="";
										pauses[3]++;
									}else if(pauses[3]<280){		
										chat.innerHTML="[Isaac] Don't trouble 'bout no two han's boss. get yo' own han'.";
										pauses[3]++;
									}else if(pauses[3]<285){
										chat.innerHTML="";
										pauses[3]++;
									}else if(pauses[3]<325){
										chat.innerHTML="[Isaac] De suckah, he'll get a han' all right, suah!";
										pauses[3]++;
									}else if(pauses[3]<330){
										chat.innerHTML="";
										pauses[3]++;
									}else if(pauses[3]<365){
										bgimg.style.visibility="hidden";
										fgtalk.style.visibility="visible";
										fgimg.style.visibility="visible";
										Andrews.setPos("15px","-50px;");
										fgimg.src=Andrews.avatar;
										Andrews.speak("bubble-left","Back. Alright, let's play cards!");
										chat.style.textAlign="center";
										chat.innerHTML="[Game Continues]";
										riff.play();
										pauses[3]++;
									}else if(pauses[3]<395){
										Andrews.speak("bubble-left","You guys know the drill.");
										pauses[3]++;
									}else if(pauses[3]<430){
										riff.pause();
										deal.play();
										Andrews.speak("bubble-left","Ante up fellas.");
										deal.play();
										cards.innerHTML="";
										pauses[3]++;
									}else{
										pub.pause();
										pauses.push(0);
										promptUser();
									}
									break;
							case 4:
									if(pauses[4]<35){
										keyboard.style.display="none";
										fgimg.src=Andrews.avatar;
										Andrews.setScale();
										Andrews.setPos("15px","-50px;");
										Andrews.speak("console","Hey, quit fussing with those cards!");
										pauses[4]++;
									}else if(pauses[4]<40){
										chat.innerHTML="";
										pauses[4]++;
									}else if(pauses[4]<90){
										let color=isRed(holecard)?"red":"black",
												suit=getSuitSymbol(getSuit(holecard)),
												val=holecard.slice(0,-1);
										hideMessage();
										fgimg.style.visibility="visible";
										fgtalk.style.visibility="visible";
										bgimg.style.visibility="hidden";
										pub.volume=0.25;
										pub.loop=true;
										pub.play();
										Andrews.speak("bubble-left",`...and I bet you're holding the <span style="color:${color};">${val}${suit}</span>`);
										chat.innerHTML="[Andrews]";
										pauses[4]++;
									}else if(pauses[4]<95){
										chat.innerHTML="";
										pauses[4]++;
									}else if(pauses[4]<135){
										Isabel.setPos("-535px","-70px");
										fgimg.src=Isabel.avatar;	
										Isabel.speak("bubble-right","I only go home with winners, kid.");
										pauses[4]++;
									}else if(pauses[4]<175){
										fgimg.src=Amos.avatar;
										Amos.setPos("0px","-75px");
										Amos.setScale();
										Amos.speak("bubble-left",'Hey, hold on! Andrews, what about the "lucky card" rule?');
										chat.innerHTML="[Lucky Card]";
										pauses[4]++;
									}else if(pauses[4]<205){
										Amos.speak("bubble-left","<br>Check the sign!<br><br>");
										pauses[4]++;
									}else if(pauses[4]<245){
										fgimg.style.visibility="hidden";
										fgtalk.style.visibility="hidden";
										bgimg.style.visibility="visible";
										cardOnSign.innerHTML=`${holecard}`;
										bgimg.style.zIndex="0";
										cardOnSign.style.zIndex="4";
										cardOnSign.style.display="block";
										Sign.setScale();
										Sign.setDimensions("100px","110px");
										Sign.setPos("250px","115px");
										bgimg.src=Sign.img.src;
										pauses[4]++;
									}else if(pauses[4]<275){
										cardOnSign.style.display="none";
										bgimg.style.visibility="hidden";
										fgimg.style.visibility="visible";
										fgimg.src=Andrews.avatar;
										Andrews.setScale();
										Andrews.setPos("15px","-50px;");
										fgtalk.style.visibility="visible";
										Andrews.speak("bubble-left","Arggggh!!! I need a moment! ...be back in five!");
										pauses[4]++;
									}else if(pauses[4]<280){
										fgtalk.style.visibility="hidden";
										fgimg.style.visibility="hidden";
										chat.innerHTML="";
										Table.setDimensions("260px","110px");
										Table.setPos("170px","130px");
										Table.setScale();
										Table.img.src=(temphand.length==4)?table4.src:table5.src;
										bgimg.src=Table.img.src;
										bgimg.style.visibility="visible";
										pauses[4]++;
									}else if(pauses[4]<310){
										Ned.speak("console","I don't remember that being on there...");
										pauses[4]++;
									}else if(pauses[4]<315){
										chat.innerHTML="";
										pauses[4]++;
									}else if(pauses[4]<330){
										Amos.speak("console","Shhhh....");
										pauses[4]++;
									}else if(pauses[4]<335){
										chat.innerHTML="";
										pauses[4]++;
									}else if(pauses[4]<375){
										Amos.speak("console","I wrote it in when he wasn't looking.");
										fgimg.src=Andrews.avatar;
										pauses[4]++;
									}else if(pauses[4]<405){
										bgimg.style.visibility="hidden";
										fgimg.style.visibility="visible";
										fgtalk.style.visibility="visible";
										Andrews.speak("bubble-left","Back! Alright. Boys, money on the table, no go to the pockets.");
										riff.play();
										chat.innerHTML="";
										pauses[4]++;	
									}else if(pauses[4]<425){
										chat.innerHTML="[Shuffling]";
										pauses[4]++;	
									}else if(pauses[4]<475){
										bgimg.style.visibility="visible";
										fgimg.style.visibility="hidden";
										fgtalk.style.visibility="hidden";
										riff.loop=true;
										Shuffle.img.src=riffle.src;
										Shuffle.setScale();
										Shuffle.setDimensions("80px","100px");
										Shuffle.setPos("280px","135px");
										bgimg.src=Shuffle.img.src;	
										pauses[4]++;
									}else if(pauses[4]<480){
										bgimg.style.visibility="hidden";
										pauses[4]++;
									}else if(pauses[4]<520){
										bgimg.style.visibility="visible";
										Shuffle.setDimensions("80px","100px");
										Shuffle.img.src=spring.src;
										bgimg.src=Shuffle.img.src;
										pauses[4]++;
									}else if(pauses[4]<525){
										chat.innerHTML="";
										pauses[4]++;
									}else if(pauses[4]<530){
										Table.setDimensions("260px","110px");
										Table.setPos("170px","130px");
										Table.setScale();
										bgimg.src=emptyTable.src;
										riff.pause();
										deal.play();		
										pauses[4]++;
									}else if(pauses[4]<570){
										Andrews.speak("console","Ante Up.");
										fgimg.src=Chips.img.src;
										fgimg.style.visibility="visible";
										cards.innerHTML="";
										pauses[4]++;
									}else{
										pub.pause();
										pauses.push(0);
										promptUser();
									}
									break;
							case 5:
									if(pauses[5]<35){
										keyboard.style.display="none";
										fgimg.src=Andrews.avatar;
										Andrews.setScale();
										Andrews.setPos("15px","-50px;");
										chat.innerHTML="";
										pauses[5]++;
									}else if(pauses[5]<95){
										let color=isRed(holecard)?"red":"black",
												suit=getSuitSymbol(getSuit(holecard)),
												val=holecard.slice(0,-1);
										hideMessage();
										fgimg.style.visibility="visible";
										fgtalk.style.visibility="visible";
										bgimg.style.visibility="hidden";
										pub.volume=0.25;
										pub.loop=true;
										pub.play();
										Andrews.speak("bubble-left",`Betcha got the <span style="color:${color};">${val}${suit}</span>, kid.`);
										chat.innerHTML="[Andrews]";
										riff.play();
										riff.loop=true;
										pauses[5]++;
									}else if(pauses[5]<100){
										chat.innerHTML="";
										pauses[5]++;
									}else if(pauses[5]<130){
										fgimg.style.visibility="hidden";
										fgtalk.style.visibility="hidden";
										bgimg.style.visibility="visible";
										Shuffle.setScale();
										Shuffle.setDimensions("80px","100px");
										Shuffle.setPos("280px","135px");
										Shuffle.img.src=riffle.src;
										bgimg.src=Shuffle.img.src;	
										chat.innerHTML="[Shuffling]";
										pauses[5]++;	
									}else if(pauses[5]<145){
										Table.setDimensions("260px","110px");
										Table.setPos("170px","130px");
										Table.setScale();
										bgimg.src=emptyTable.src;
										chat.innerHTML="";
										riff.pause();
										deal.play();	
										pauses[5]++;
									}else if(pauses[5]<220){
										Ned.speak("console","Say, you're dealing off the bottom!");	
										cards.innerHTML="";
										pauses[5]++;
									}else if(pauses[5]<225){
										chat.innerHTML="";
										pauses[5]++;
									}else if(pauses[5]<265){
										Andrews.speak("console","So what! It's my deal, isn't it?");
										pauses[5]++;
									}else if(pauses[5]<270){
										chat.innerHTML="";
										pauses[5]++;
									}else if(pauses[5]<300){
										Andrews.speak("console","Alright, boys. Ante up.");
										fgimg.src=Chips.img.src;
										fgimg.style.visibility="visible";
										pauses[5]++;
									}else{
										pub.pause();
										pauses.push(0);
										promptUser();
									}
									break;
							case 0:
									if(pauses[0]<5){
										hideMessage();
										bgimg.style.visibility="hidden";
										fgimg.style.visibility="hidden";
										fgtalk.style.visibility="hidden";
										pauses[0]++;
									}else if(pauses[0]<35){
										container.style.backgroundColor="white";
										bgimg.style.height="110px";
										bgimg.style.width="90px";
										bgimg.src=gunOut.src; //presetting image for next
										Andrews.speak("console","Hey! Whatcha doing with them cards?");
										suspense.play();
										chat.style.textAlign="left";
										pauses[0]++;
									}else if(pauses[0]<40){
										chat.innerHTML="";
										pauses[0]++;
									}else if(pauses[0]<115){
										bgimg.style.visibility="visible"; //show preset image
										heartbeat.play();
										Andrews.speak("console",`You got that ${holecard} from your sleeve! Now, I'mma put some lead in you!`);
										pauses[0]++;
									}else if(pauses[0]<120){
										chat.innerHTML="";
										pauses[0]++;
									}else if(pauses[0]<165){
										chat.innerHTML="[Isaac] He did boss, he did! I seens it alright!";
										pauses[0]++;
									}else if(pauses[0]<170){
										chat.innerHTML="";
										pauses[0]++;
									}else if(pauses[0]<250){
										bgimg.style.visibility="hidden";
										container.style.backgroundColor="black";
										introOutro.play();	
										chat.style.textAlign="center";
										chat.innerHTML="[Game Over]";
										cards.innerHTML="";
										pauses[0]++;
										}else{
										promptUser();
									}
									break;
							default:
								promptUser();
						}
					}else{ //story off
						promptUser();
					}


					Timer=setTimeout(game, refresh);
				}
				const promptUser=()=>{
					chat.innerHTML="";
					chat.style.textAlign="left";
					chat.innerHTML="Enter known up cards. . .";
					keyboard.style.display="block";
					hideMessage();
					hideMainStory();
					cards.style.display="block";
					chat.style.display="block";
				}
				const hideMainStory=()=>{
					bgimg.style.display="none";
					fgtalk.style.display="none";
					fgimg.style.visibility="hidden";
					fgdiv.style.visibility="hidden";
				}
				const displayMessage=()=>{
					hideMainStory();	
					generalmessage.style.display="block";
					generalmessage.style.fontSize="35px";
					generalmessage.style.fontFamily="Comic Sans MS";
					generalmessage.style.textAlign="left";
					//generalmessage.style.height="260px";
					generalmessage.style.width="770px";
					generalmessage.style.zIndex="0";
				}

				const hideMessage=()=>{
					generalmessage.style.display="none";
					bgimg.style.display="block";
					fgtalk.style.display="block";
					fgimg.style.visibility="visible";
					fgdiv.style.visibility="visible";
				}

				const toggleStory=()=>{
					//Toggling story can mess up positioning when returning to the story
					//therefore, hiding after user clicks
					let s=document.getElementById("story");
					game();
					if(story){
						story=false;
						s.innerHTML="Story: Off";
						promptUser();
						s.style.display="none";
					}else{
						story=true;
						s.innerHTML="Story: On";
						s.style.display="none";
					}
				}

				const forceHandCheck=(forcehand)=>{
					//assumes forcehand passed in is set previously to temphand from first round of 4 or 5
					let matched=[]; //tracks matched cards

					if(forcehand.length==0)
						return;

					//update matched cards
					for(let v of temphand)
						for(let v1 of forcehand)
							if(v==v1)		
								matched.push(v); //if matched, add to matched array

					//sort forcehand and matched arrays (type of sort doesn't matter as long as they are the same)
					forcehand.sort();
					matched.sort();

					//if one less than forcehand length, return unmatched card
					if(matched.length==forcehand.length-1) 
						for(let i in forcehand)
							if(forcehand[i] != matched[i])
								return forcehand[i];

					return false;
				}

				const forceSet=(x)=>{
					//used to set initial force hand as well as call forceHandCheck() to check if forcehand is current
					//if forcehand is current, will set holecard to missing card from forcehands[x]
					if(forcehands[x].length==0) //set forcehand to inital hand for 4 or 5
						forcehands[x]=[...temphand];	

					if(forceHandCheck(forcehands[x])){
						scene=0;
						holecard=forceHandCheck(forcehands[x]);
					}
				}

				const updateCards=(val,type)=>{
					//val is number of letter representation
					//type: (ex. suit, card, del)
					if(cards.innerHTML.slice(-1)=="_") //check for display cursor and remove
						cards.innerHTML=cards.innerHTML.slice(0,-1);
					if(type=="del"){
						cards.innerHTML=cards.innerHTML.slice(0,-1);
						return;
					}
					if(type=="suit") //do not allow a suit to be updated directly after a space of X
						if(cards.innerHTML.slice(-1)==" " || cards.innerHTML.slice(-1)=="X")
							return;
					if(val=="X" || type=="num") //verify X and numbers are preceded by a space (if not remove the character/s)
						if(cards.innerHTML.slice(-1)!=" ")
							if(cards.innerHTML.slice(-1)=="0") //check for 10 since has two chars
								cards.innerHTML=cards.innerHTML.slice(0,-2);
							else
								cards.innerHTML=cards.innerHTML.slice(0,-1);

					//once previous checks pass, display can be successfully updated
					
					cards.innerHTML+=val; //update display

					if(type=="suit" || val=="X") //add space if complete
						cards.innerHTML+=" ";
				}

				const showdown=()=>{
							mode="low"; //set to default of low (later checks will set to other modes if applicable)

					if(cards.innerHTML.slice(-1)=="_") //check for display cursor and remove
						cards.innerHTML=cards.innerHTML.slice(0,-1);

					if(cards.innerHTML.trim().split(/[ ,]+/).length<4) //check if all cards entered
						return;
					else if(cards.innerHTML.trim().split(/[ ,]+/).length>5) //check if too many cards entered
						return -1;

					
					cards.innerHTML=cards.innerHTML.replace("_",""); //remove display cursor if present
					setTempHand(cards.innerHTML.trim());
					setHand();

					if(temphand.length!=[...new Set(temphand)].length) //duplicates
						return -2;

					drumSound.play();
					encode();
					holecard=decode();
					scene++;

					//check for initial hand (set force hand) and check for result to override
					if(temphand.length==4)
						forceSet(0);
					else if(temphand.length==5)
						forceSet(1);

					
					cards.innerHTML="";
					//showHideKeys();
					chat.style.textAlign="center";
					chat.innerHTML="[Showdown]";
										
					sleep(5000).then(() => {	
						cards.innerHTML=`${holecard} `;
					});

				}

				function sleep (time){
					return new Promise((resolve) => setTimeout(resolve, time));
				}

				window.onload=init;

			</script>
			<style>
			/*
				Title Text Effect, thanks to: http://codepen.io/Moslim/
				Talk/Text Bubble Effect, thanks to: https://codepen.io/run-time/pen/VNRBJd 
				Background Opacity Effect, thanks to: https://www.digitalocean.com/community/tutorials/how-to-change-a-css-background-images-opacity
				Backgroun Wood Grain Image, thanks to: pixelbuddha.net
				Scale image, thanks to: https://stackoverflow.com/questions/8397049/css-image-resize-percentage-of-itself
				Sound effects, thanks to: https://mixkit.co/free-sound-effects/game/ , https://pixabay.com/sound-effects/ , https://bigsoundbank.com/
			 */
		* { touch-action: manipulation; }

				body {
					background:black;
					background-image: linear-gradient(black, silver); /*Gradient*/
					background-repeat: no-repeat;
					color:lightyellow;
					font-size:10px;
				}

				/*Title Effect*/
				.title {
					text-align: center;
					color: lightgray;
					display: flex;
					flex-direction: column;
					align-items: center;
					justify-content: center;
					height: 15vh;
					letter-spacing: 1px;
					line-height:1;
					/*Font-Border */
					 -webkit-text-stroke: 1px silver; /* width and color */
					 font-family: sans;
					/*End Font-Border*/
				}

				h1 {
					background-image: url(https://media.giphy.com/media/26BROrSHlmyzzHf3i/giphy.gif);
					background-size: cover;
					color: transparent;
					-moz-background-clip: text;
					-webkit-background-clip: text;
					text-transform: uppercase;
					font-size: 100px;
					margin: 10px 0;
				}
				/* styling my button */

				.white-mode {
					text-decoration: none;
					padding: 7px 10px;
					background-color: #122;
					border-radius: 3px;
					color: #FFF;
					transition: .35s ease-in-out;
					position: absolute;
					left: 15px;
					bottom: 15px;
					font-family: "Montserrat";
				}

				.white-mode:hover {
					background-color: #FFF;
					color: #122;
				}
				/* End Title Effect */	

				h2 {
						font-size:45px;
						color:silver;
						-webkit-text-stroke: 2px black; /* width and color */
				}
				
				#monitor {
					width:815px;
					height:610px;
					border:20px inset gray;
				}
				
				#storyboard-outer {
					width:800px;
					height:590px;
					background-color:black;
					border:8px solid green;
				}

				#screen {
					width:800px;
					font-size:30px;
					font-family:Courier, monospace; 
				}

				#chat {
					text-align:left;
					padding:10px;
					border-top:2px solid green;
					border-bottom:2px solid green;
					height:70px;
					color:#49F55B;
					font-weight:bold;
				}

				#cards {
					padding:10px;
					background-color:black;
					color:#49F55B;
					font-size:65px;
					text-align:center;
					position:relative;
					/*Vertical Align Text*/
					display: table-cell;
					vertical-align: middle;
					/*End Vertical Align Text*/
				}

				#play {
					width:400px;
					font-size:60px;
					background-color:green;
					color:black;
					border:2px outset silver;
				}

				#keyboard {
					width:900px;
					display:none;
				}

				#story-container {
					position: relative;
    			display: inline-block;
				}

				#itwaswritten {
					display:none;
					color:lightyellow;
					font-size:40px;
					font-family:"Comic Sans MS", "Comic Sans", "Montserrat", cursive;
					position: absolute;
					top: 82%;
					left: 50%;
					transform: translate( -50%, -82% );
					text-align: center;
					opacity:0.7;
				}

				.keys {
					width: 160px;
					height:80px;
					background-color:#B3B3B3;
					color:black;
					font-size:50px;
					font-weight:bold;
					border:5px outset silver;
					box-shadow: 15px 15px 30px 10px black;
				}

				.keys-suits {
					border:5px outset silver;
					background-color:#C4C4C4;
					color:black;
					/*Vertical Align Text on Button*/
					display: table-cell;
					vertical-align: middle;
					/*End Vertical Align Text*/
					width:110px;
					font-size:60px;
					box-shadow: 15px 15px 30px 10px black;
				}

				.character {
					/*scale image*/
					-webkit-transform: scale(2); /* Saf3.1+, Chrome */
					-moz-transform: scale(2); /* FF3.5+ */
					-ms-transform: scale(2); /* IE9 */
					-o-transform: scale(2); /* Opera 10.5+ */
					transform: scale(2);
						 /* IE6â€“IE9 */
					filter: progid:DXImageTransform.Microsoft.Matrix(M11=0.9999619230641713, M12=-0.008726535498373935, M21=0.008726535498373935, M22=0.9999619230641713,SizingMethod='auto expand');
					/*End Scale Image*/
					z-index:2;
				}

				.bgscene {
					z-index:0;
					text-align:left;
					/*scale image*/
					-webkit-transform: scale(5); /* Saf3.1+, Chrome */
					-moz-transform: scale(5); /* FF3.5+ */
					-ms-transform: scale(5); /* IE9 */
					-o-transform: scale(5); /* Opera 10.5+ */
					transform: scale(5);
						 /* IE6â€“IE9 */
					filter: progid:DXImageTransform.Microsoft.Matrix(M11=0.9999619230641713, M12=-0.008726535498373935, M21=0.008726535498373935, M22=0.9999619230641713,SizingMethod='auto expand');
					/*End Scale Image*/	
				}

				/*Talk Bubble*/

				.bubble {
					top:-40px;
					position: relative;
					font-family: Courier, monospace;
					font-size: 30px;
					font-weight:bold;
					line-height: 30px;
					width: 400px;
					background: #fff;
					border-radius: 40px;
					padding: 25px;
					text-align: center;
					color: #000;
					z-index:1;
				}

				.bubble-bottom-left:before {
					content: "";
					width: 0px;
					height: 0px;
					position: absolute;
					border-left: 24px solid #fff;
					border-right: 12px solid transparent;
					border-top: 12px solid #fff;
					border-bottom: 20px solid transparent;
					left: 32px;
					bottom: -24px;
				}
				
				.bubble-bottom-right:after {
					content: "";
					width: 0px;
					height: 0px;
					position: absolute;
					border-right: 24px solid #fff;
					border-left: 12px solid transparent;
					border-top: 12px solid #fff;
					border-bottom: 20px solid transparent;
					right: 32px;
					bottom: -24px;
				}

				/*End Talk Bubble*/	

				/*Background-Image Opacity*/
				.wrap {
					overflow: hidden;
					position: relative;
				}

				.bg {
					opacity: 0.2;
					position: absolute;
					left: 0;
					top: 0;
					width: 100%;
					height: auto;
					/*scale image*/
					-webkit-transform: scale(1); /* Saf3.1+, Chrome */
					-moz-transform: scale(1); /* FF3.5+ */
					-ms-transform: scale(1); /* IE9 */
					-o-transform: scale(1); /* Opera 10.5+ */
					transform: scale(1);
						 /* IE6â€“IE9 */
					filter: progid:DXImageTransform.Microsoft.Matrix(M11=0.9999619230641713, M12=-0.008726535498373935, M21=0.008726535498373935, M22=0.9999619230641713,SizingMethod='auto expand');
					/*End Scale Image*/
				}

				.content {
					position: relative;
				}

				/*End Background-Image Opacity*/
								
			</style>
	</head>
	<body>
		<div class="wrap">
				<img class="bg" src="./images/wood.jpg" alt="">
				<br>
				<center class="content">
				<div class="title">
					<h1>CHEATER'S POKER</h1>
					<h2>ERDNASE EDITION</h2>
				</div>
				<div id="monitor">
								<div id="storyboard-outer">
									<div id="status-board"></div>
									<div id="general-message"></div>
									<span id="storyboard-inner">
													<div style="height:360px;" id="story-container">
																	<!--<div class="bubble bubble-bottom-right">Howdy, I'm Amos. Some people just call me &quot;Old Man&quot;. I'll be your guide.</div>-->
																	<div style="text-align:left;width:600px;left:30px;top:150px;position:relative;z-index:0;" id="bgdiv">
																		<img src="./images/HaveASeat.png" class="bgscene" id="bgimg">
																	</div>
																	<div id="itwaswritten"></div>
																	<div class="bubble bubble-bottom-right" id="fgtalk">Off to a fresh start. Don't know what lies ahead.</div>	
																	<div style="text-align:right;width:600px;left:15px;top:-100px;position:relative;z-index:1;" id="fgdiv">
																					<img src="./images/Evans.png" class="character" id="fgimg">
																	</div>
																	<!--<div class="bubble bubble-bottom-left">Type any text here and the bubble will grow to fit the text no matter how many lines.	Isn't that nifty?</div>	-->
													</div>
													<div id="screen">
														<div id="chat">Loading...</div>
														<span id="cards"><button id="play">Play Now</button></span>
													</div>
									</span>
							</div>
			</div>		
			<br>
			<button id="showhidekeys" class="keys" style="font-size:40px;width:620px;color:silver;background-color:black;display:none;">Show/Hide Keyboard</button>
			<br>
			<div id="keyboard">
							<br><br>
							<button class="keys-suits" onclick="updateCards('C','suit');">&clubs;</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="keys-suits" onclick="updateCards('H','suit');" style="color:red;">&hearts;</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="keys-suits" onclick="updateCards('S','suit');">&spades;</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="keys-suits" onclick="updateCards('D','suit');" style="color:red;">&diams;</button>
							<br><br><br>
							<button class="keys" onclick="updateCards('K','num');">K</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="keys" onclick="updateCards('X','X');">X</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<!--
											<button class="keys" style="width:97px;">&lt;</button>&nbsp;&nbsp;&nbsp;&nbsp;
											<button class="keys" style="width:97px;">&gt;</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							-->
							<button class="keys" onclick="updateCards('0','del');" style="font-size:40px;top:-3px;position:relative;">DEL</button>
							<br><br><br>
							<button class="keys" onclick="updateCards('10','num');">10</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="keys" onclick="updateCards('J','num');">J</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="keys" onclick="updateCards('Q','num');">Q</button>
							<br><br><br>
							<button class="keys" onclick="updateCards('7','num');">7</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="keys" onclick="updateCards('8','num');">8</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="keys" onclick="updateCards('9','num');">9</button>
							<br><br><br>
							<button class="keys" onclick="updateCards('4','num');">4</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="keys" onclick="updateCards('5','num');">5</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="keys" onclick="updateCards('6','num');">6</button>
							<br><br><br>
							<button class="keys" onclick="updateCards('A','num');">A</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="keys" onclick="updateCards('2','num');">2</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<button class="keys" onclick="updateCards('3','num');">3</button>
							<br><br><br>
							<button class="keys" style="font-size:40px;width:550px;position:relative;" onclick="showdown();">SHOWDOWN</button>
							<br><br>
			</div>
			<button id="story" style="width:500px;background-color:black;color:brown;font-size:40px;">Turn Off Story</button>
		</center>
	 <br><br>
	</div>
	</body>
</html>
